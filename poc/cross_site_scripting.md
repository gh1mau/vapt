### Cross Site Scripting

| Vulnerability          | Cross Site Scripting                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|:---------------------- |:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Severity**           | **HIGH**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| **Affected URL**       | <insert the affected url\(s\)>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| **Tools**              | Burp Suite, [XSStrike](https://github.com/gh1mau/vapt/blob/main/poc/cross_site_scripting.md#xsstrike)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **Techniques/ Method** | URL Fuzzing, Parameter Tampering                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **Proof of Concept**   | <insert POC screenshot\(s\)>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **Payload\(s\)**       | [List of possible payload](https://github.com/gh1mau/vapt/blob/main/poc/cross_site_scripting.md#possible-payloads)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **Description**        | Cross\-site Scripting \(XSS\) refers to client\-side code injection attack wherein an attacker can execute malicious scripts into a legitimate website or web application\. XSS occurs when a web application makes use of unvalidated or unencoded user input within the output it generates\.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **Impact**             | Malicious JavaScript has access to all the same objects as the rest of the web page, including access to cookies and local storage, which are often used to store session tokens. If an attacker can obtain a user's session cookie, they can then impersonate that user.<br/>Furthermore, JavaScript can read and make arbitrary modifications to the contents of a page being displayed to a user\. Therefore, XSS in conjunction with some clever social engineering opens up a lot of possibilities for an attacker\.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **CVE/CWE/OSVDB**      | CWE\-79                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| Recommendation         | **Apply context\-dependent encoding and/or validation to user input rendered on a page.**<br/><br/>In order for a Cross\-site scripting \(XSS\) attack to take place, an attacker does not directly target a victim\. Instead, an attacker exploits a vulnerability in a web application visited by a victim, where the web application is used to deliver the malicious JavaScript\. The victim's browser is not able to distinguish between malicious and legitimate JavaScript, and therefore, executes the attacker's malicious payload\. <br/> Since cross\-site scripting \(XSS\) is user input which is interpreted as code\. In order to prevent XSS, secure input handling is necessary\. The two fundamental methods of handling untrusted user input are encoding and validation\. <br/><br/> • **Encoding** - Escapes user input so that browsers interpret it as data, not as code <br/>• **Validation** \- Filters user input so that browsers interpret it as code without malicious commands <br/><br/>Encoding and validation are two different techniques to preventing cross\-site scripting \(XSS\)\. Deciding which should be used highly depends on the context within which the untrusted user input is being inserted\. |
| References             | [Cross site scripting](https://en.wikipedia.org/wiki/Cross-site_scripting)<br/>[Excess XSS, a comprehensive tutorial on cross-site scripting](https://excess-xss.com/)<br/>[XSS Filter Evasion Cheat Sheet](https://owasp.org/www-community/xss-filter-evasion-cheatsheet)<br/>[CWE-79: Improper Neutralization of Input During Web Page Generation (Cross-site Scripting)](https://cwe.mitre.org/data/definitions/79.html)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |

---

### Tools :

#### XSStrike

Reference: [Home · s0md3v/XSStrike Wiki · GitHub](https://github.com/s0md3v/XSStrike/wiki)

```bash
# installing XSStrike:
$ git clone https://github.com/s0md3v/XSStrike.git

$ cd XSStrike

$ pip3 install -r requirements.txt

# running XSStrike (crawl)
$ python3 xsstrike.py -u "http://localhost/index.php" --crawl

# running XSStrike (GET parameter)
$ python3 xsstrike.py -u "http://localhost/profile.php?nokp="
```

![](https://github.com/gh1mau/vapt/blob/main/image/xsstrike_1.png "XXStrike")

![](https://github.com/gh1mau/vapt/blob/main/image/xsstrike_2.png)

---

### Possible Payloads

```javascript
=>"'><script>alert('gh1mau')</script>

=%3E%22'%3E%3Cscript%3Ealert('gh1mau')%3C/script%3E 

%22%3Cd3V%0dOnmouSEoVeR%09=%09confirm(%22gh1mau%22)%3E%3Ch1%3Egh1mau%3C/h1%3E
```
